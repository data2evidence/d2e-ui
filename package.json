{
  "name": "d2e-ui",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "build-all": "npx nx run-many --targets=build --projects=@portal/components,@portal/plugin && npx nx run-many --targets=build,build-mri --exclude @portal/components,@portal/plugin && yarn build-ui5",
    "build-all-skip-cache": "npx nx run-many --targets=build --projects=@portal/components,@portal/plugin --skip-nx-cache && npx nx run-many --targets=build,build-mri --exclude @portal/components,@portal/plugin --skip-nx-cache && yarn build-ui5",
    "build-ui5": "yarn ui5 build -a --clean-dest --dest ./resources/ui5",
    "mri-vue": "yarn; nx build vue-mri",
    "portal-ui": "yarn; nx build @portal/plugin; nx build @portal/components; nx build portal; nx build-mri portal",
    "superadmin-ui": "yarn; nx build @portal/plugin; nx build @portal/components; nx build superadmin",
    "flow": "yarn; nx build @portal/plugin; nx build @portal/components; nx build flow",
    "analysis": "yarn; nx build @portal/plugin; nx build @portal/components; nx build analysis_flow",
    "base:ui": "REPO_RELATIVE_PATH='../d2e' && GIT_HEAD_COMMIT_ALP_UI_REPO=$(git rev-parse HEAD) docker compose --file ${REPO_RELATIVE_PATH}/docker-compose.yml --file ${REPO_RELATIVE_PATH}/docker-compose-local.yml",
    "az:start:ui": "yarn base:ui up alp-caddy",
    "start:ui": "yarn az:start:ui",
    "build:start:ui": "yarn base:ui --file docker-compose-ui.yml up alp-caddy",
    "build:ui": "yarn base:ui --file docker-compose-ui.yml build alp-caddy",
    "prepack": "yarn build-all"
  },
  "workspaces": {
    "packages": [
      "libs/*",
      "apps/*"
    ],
    "nohoist": [
      "**/@vue",
      "**/@vue/**"
    ]
  },
  "devDependencies": {
    "@ui5/cli": "^2.12.0",
    "nx": "^18.0.0"
  },
  "trex" : {
    "ui": {
    "routes": [
      {
        "source": "/portal",
        "target": "/resources/portal"
      },
      {
        "source": "/flow",
        "target": "/resources/flow"
      },
      {
        "source": "/analysis",
        "target": "/resources/analysis"
      },
      {
        "source": "/mapping",
        "target": "/resources/mapping"
      },
      {
        "source": "/log-viewer",
        "target": "/resources/log-viewer"
      },
      {
        "source": "/starboard-jupyter",
        "target": "/resources/starboard-jupyter"
      },
      {
        "source": "/mri",
        "target": "/resources/mri"
      },
      {
        "source": "/hc/hph/core/ui",
        "target": "/resources/mri-ui5/utils/core"
      },
      {
        "source": "/hc/hph/config/global/ui",
        "target": "/resources/mri-ui5/utils/global"
      },
      {
        "source": "/hc/mri/pa/config/ui",
        "target": "/resources/mri-ui5/PatientAnalyticsConfig/ui5/"
      },
      {
        "source": "/hc/mri/pa/ui",
        "target": "/resources/mri-ui5/mri-pa-ui/mri/"
      },
      {
        "source": "/hc/hph/genomics/ui",
        "target": "/resources/mri-ui5/genomics-ui/ui/"
      },
      {
        "source": "/hc/mri/pa/config/i18n",
        "target": "/resources/mri-ui5/PatientAnalyticsConfig/ui5/i18n/"
      },
      {
        "source": "/ui/core",
        "target": "/resources/ui5/resources/sap/ui/core/"
      },
      {
        "source": "/ui/m",
        "target": "/resources/ui5/resources/sap/m"
      },
      {
        "source": "/hc/hph/patient/app/ui",
        "target": "/resources/mri-ui5/chp-ps-ui"
      },
      {
        "source": "/hc/hph/cdw/config/i18n",
        "target": "/resources/mri-ui5/CDM/ui5/i18n/"
      },
      {
        "source": "/hc/hph/cdw/config/ui",
        "target": "/resources/mri-ui5/CDM/ui5"
      },
      {
        "source": "/hc/hph/patient/config/ui",
        "target": "/resources/mri-ui5/PatientSummaryConfig/ui5/"
      },
      {
        "source": "/hc/hph/patient/shared",
        "target": "/resources/mri-ui5/PatientSummaryConfig/ui5/shared"
      },
      {
        "source": "/hc/hph/patient/config/i18n",
        "target": "/resources/mri-ui5/PatientSummaryConfig/ui5/i18n/"
      },
      {
        "source": "/ui",
        "target": "/resources/ui5/resources/"
      }
    ]
  ,"uiplugins": {
    "researcher": [
      {
        "enabled": true,
        "featureFlag": "conceptSets",
        "name": "Concepts",
        "pluginPath": "plugins/Researcher/ConceptSets/module",
        "requiredRoles": [
          "RESEARCHER"
        ],
        "route": "concepts"
      },
      {
        "enabled": true,
        "featureFlag": "cohort",
        "name": "Cohorts",
        "pluginPath": "plugins/mri/PatientAnalytics/module",
        "requiredRoles": [
          "RESEARCHER"
        ],
        "route": "cohort"
      },
      { 
        "enabled": false,
        "featureFlag": "cohorts",
        "name": "Cohorts M", 
        "pluginPath": "plugins/Cohort/module",
        "requiredRoles": [ 
          "RESEARCHER" 
        ], 
        "route": "cohorts"
      },
      {
        "enabled": true,
        "featureFlag": "starboard",
        "name": "Notebooks",
        "pluginPath": "plugins/Starboard/module",
        "requiredRoles": [
          "RESEARCHER"
        ],
        "route": "starboard",
        "subMenus": "true"
      },
      {
        "enabled": false,
        "featureFlag": "analysisFlow",
        "name": "Analysis",
        "route": "analysis_parent",
        "requiredRoles": [
          "RESEARCHER"
        ],
        "children": [
          {
            "name": "Kaplan-Meier",
            "route": "kaplan-meier",
            "pluginPath": "plugins/Researcher/KaplanMeier/module",
            "featureFlag": "kaplanMeier",
            "requiredRoles": ["RESEARCHER"],
            "enabled": true
          },
          {
            "name": "Strategus",
            "route": "analysis",
            "data": {
              "dnBaseUrl": "https://$$FQDN$$/"
            },
            "pluginPath": "https://$$FQDN$$/analysis/module.js",
            "featureFlag": "strategus",
            "requiredRoles": ["RESEARCHER"],
            "enabled": true
          }
        ]
      }
    ],
    "setup": [
      {
        "description": "Database connection and credentials",
        "enabled": true,
        "name": "Databases",
        "notes": "",
        "pluginPath": "plugins/Setup/Db/module",
        "route": "db"
      },
      {
        "description": "Allow user to sign-in with Azure Active Directory",
        "enabled": false,
        "name": "Azure AD integration",
        "notes": "Notes: Require manual update of the environment variable to switch the identity provider to Azure",
        "pluginPath": "plugins/Setup/AzureAD/module",
        "route": "azure-ad"
      },
      {
        "description": "Enable / disable feature",
        "enabled": true,
        "name": "Feature flags",
        "pluginPath": "plugins/Setup/Feature/module",
        "route": "feature"
      },
      {
        "description": "Configure dataset metadata and tags",
        "enabled": true,
        "name": "Metadata",
        "notes": "",
        "pluginPath": "plugins/Setup/Metadata/module",
        "route": "metadata"
      },
      {
        "description": "Configure patient analytics",
        "enabled": true,
        "name": "Patient Analytics Config",
        "notes": "",
        "pluginPath": "plugins/mri/PatientAnalyticsConfig/module",
        "route": "pa-config"
      },
      {
        "description": "Configure CDM",
        "enabled": true,
        "name": "CDM Config",
        "notes": "",
        "pluginPath": "plugins/mri/CDM/module",
        "route": "cdm-config"
      },
      {
        "description": "Configure patient summary",
        "enabled": false,
        "name": "Patient Summary Config",
        "notes": "",
        "pluginPath": "plugins/mri/PatientSummaryConfig/module",
        "route": "ps-config"
      },
      {
        "description": "Map codes from a source system into terminologies stored in OMOP Vocabulary",
        "enabled": true,
        "name": "Concept Mapping",
        "notes": "",
        "pluginPath": "plugins/Setup/ConceptMapping/module",
        "route": "concept-mapping"
      },
      {
        "description": "Configure hybrid search for concepts",
        "enabled": true,
        "name": "Hybrid Search",
        "notes": "",
        "pluginPath": "plugins/Setup/HybridSearch/module",
        "route": "hybrid-search"
      },
      {
        "description": "Configure overview description text",
        "enabled": true,
        "name": "Overview description",
        "notes": "",
        "pluginPath": "plugins/Setup/OverviewDescription/module",
        "route": "overview-description"
      }
    ],
    "systemadmin": [
      {
        "name": "Users",
        "pluginPath": "plugins/SystemAdmin/UserOverview/module",
        "route": "user-overview"
      },
      {
        "name": "Datasets",
        "pluginPath": "plugins/SystemAdmin/StudyOverview/module",
        "route": "dataset-overview"
      },
      {
        "name": "Jobs",
        "pluginPath": "plugins/SystemAdmin/Jobs/module",
        "route": "jobs"
      },
      {
        "data": {
          "dnBaseUrl": "https://$$FQDN$$/"
        },
        "pluginPath": "https://$$FQDN$$/mapping/module.js",
        "name": "ETL",
        "route": "etl"
      },
      {
        "name": "Sql Editor",
        "pluginPath": "plugins/SystemAdmin/Sqleditor/module",
        "route": "sqleditor"
      },
      {
        "data": {
          "dnBaseUrl": "https://$$FQDN$$/"
        },
        "name": "Dataflow",
        "pluginPath": "https://$$FQDN$$/flow/module.js",
        "route": "dataflow",
        "type": "hidden",
        "featureFlag": "dataflow",
        "enabled": "true"
      },
      {
        "name": "Setup",
        "pluginPath": "plugins/Setup/module",
        "route": "setup"
      }
    ]
  }}}
}